# CvnH - 一款为Burp Suite打造的智能规则驱动Fuzz框架

[![License](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)

**CvnH** 是一款功能强大、高度可配置的半自动化安全测试插件，专为Burp Suite设计。它不仅仅是一个简单的Fuzz工具，而是一个完整的、基于规则的测试框架，能够帮助安全研究人员和渗透测试工程师自动化地发现Web应用中的漏洞。

---

## ✨ 核心功能

* **统一且强大的规则引擎**:
    * **两种规则类型**: 支持对 **HTTP参数(Parameter)** 和 **请求头(Header)** 创建独立的Fuzz规则。
    * **精细化配置**: 每一条**参数规则**都可以独立配置其行为（替换/追加模式、Payload是否URL编码）和被动扫描时的去重策略（按完整端点或仅按主机）。
    * **智能Header Fuzz**: 每一条**Header规则**都可以独立配置当请求头不存在时是否自动添加。

* **灵活的Payload管理**:
    * **分类管理**: 可创建不同的Payload类别（如`SQL注入`, `XSS`, `命令执行`），方便管理和维护。
    * **规则联动**: Fuzz规则直接关联Payload类别，实现了规则与Payload的解耦，便于复用。

* **两种工作模式**:
    * **被动模式**: 自动监听流经Proxy和Repeater的流量，根据域名作用域和智能去重逻辑，自动对新发现的端点和Header进行Fuzz测试。
    * **主动模式**: 通过右键菜单，可以对任意请求立即发起针对性的测试，且**不受被动模式去重逻辑的限制**。

* **强大的主动测试菜单**:
    * **`Fuzz Headers`**: 针对当前请求，立即应用所有激活的Header规则进行测试。
    * **`Deleting Parameters`**: 针对当前请求的所有参数，进行逐一删除参数的测试，用于快速发现参数校验绕过等问题。

* **高效的结果分析面板**:
    * **纯粹的展示与分析**: "攻击"面板完全专注于结果展示，与配置分离，界面清晰。
    * **主从联动视图**: 清晰地展示原始请求与所有Fuzz结果之间的关联。
    * **双重动态筛选**:
        1.  **按长度变化筛选**: 可在右键菜单中一键筛选出响应长度与原始请求不同的Fuzz结果。
        2.  **按Fuzz类型筛选**: 可通过下拉框，只查看由“参数规则”、“Header规则”或“删除参数”生成的测试结果。
    * **内置报文查看器**: 集成了Burp的原生请求/响应编辑器，方便进行深度分析。

* **高度可配置**:
    * **作用域控制**: 支持域名黑/白名单以及子域名匹配。
    * **线程池自定义**: 可在UI界面自由配置核心线程、最大线程和存活时间。
    * **自定义配置文件路径**: 支持通过UI选择`config.yml`的存储位置，配置会通过Burp的API持久化保存。

---

## 📸 界面截图

**(配置面板 - 统一管理规则与Payload)**
![image](https://github.com/user-attachments/assets/c08ced82-5446-476d-88da-b8add61e3741)


**(攻击面板 - 动态筛选分析结果)**
![image](https://github.com/user-attachments/assets/78631543-7508-45d1-83d9-f2aaaa71dfda)

**


---

## 🚀 安装指南

1.  前往项目的 **Releases** 页面 。
2.  下载最新的 `CvnH-vX.X-jar-with-dependencies.jar` 文件。
3.  打开 Burp Suite, 前往 `Extender` -> `Extensions` 标签页。
4.  点击 `Add` 按钮，选择刚才下载的 JAR 文件。
5.  插件加载成功后，您应该能看到一个名为 "CvnH" 的新主标签页。

---

## ⚙️ 使用流程

1.  **第一步：配置Payloads**
    * 前往 "CvnH" -> "配置" 标签页。
    *在右侧的“Payload管理”面板中，首先创建“漏洞类别”（如`SQL-Inject`），然后在选中该类别后，添加对应的Payloads。

2.  **第二步：配置规则**
    * 在左侧的“规则引擎”面板中，点击“添加规则”。
    * 选择要创建的规则类型（参数规则或Header规则）。
    * 填写匹配规则（参数名或Header名的正则表达式）并关联一个您刚创建的Payload类别。
    * 为规则配置独立的模式（如追加、去重策略等）。

3.  **第三步：配置全局和作用域**
    * 在上方的“基础设置”中，按需调整线程数。
    * 在“域名作用域”中，添加您要测试的目标域名。

4.  **第四步：开始测试**
    * **被动测试**: 正常地使用浏览器通过Burp代理浏览您的目标网站。当有请求命中您的规则和作用域时，插件会自动在后台开始测试。
    * **主动测试**: 在Burp的任意位置（如Proxy History, Repeater）找到一个您感兴趣的请求，右键单击，选择 `Deleting Parameters` 或 `Fuzz Headers` 发起一次性的主动测试。

5.  **第五步：分析结果**
    * 前往 "CvnH" -> "攻击" 标签页查看所有结果。
    * 使用左侧表格右键菜单的“筛选长度变化”和界面下方的“筛选类型”下拉框来快速定位可疑的Fuzz结果。
    * 在表格中选择不同的行，即可在下方的编辑器中查看详细的请求和响应报文。

---

## 🤝 贡献

欢迎提交 Issue 或 Pull Request 来改进本项目。

## 📄 许可证

本项目采用 [MIT](LICENSE) 许可证。
